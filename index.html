<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Test żeglarstwo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<script>
    var questionsList = [];
    var questionId = -1

    document.addEventListener("DOMContentLoaded", function () {
        fetch('all_questions.json')
            .then(response => response.json())
            .then(data => {
                questionsList = data;
            })
            .catch(error => {
                console.error('Error fetching JSON:', error);
                document.getElementById('question').innerText = 'Błąd ładowania pytania.';
            });
    });

    function simpleShuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function setQuestion() {
        questionText = questionsList[questionId].content;
        correctAnswer = questionsList[questionId].correct_answer;
        incorrectAnswer1 = questionsList[questionId].incorrect_answer_1;
        incorrectAnswer2 = questionsList[questionId].incorrect_answer_2;

        answersList = simpleShuffle([correctAnswer, incorrectAnswer1, incorrectAnswer2]);

        document.getElementById('question').innerText = questionText;

        const answersContainer = document.getElementById('answers');
        answersContainer.innerHTML = ''

        answersList.forEach(answer => {
            const button = document.createElement('button');
            button.className = 'answer';
            button.innerText = answer;
            button.setAttribute('onclick', 'checkAnswer(this)');
            button.setAttribute('is_correct_answer', (correctAnswer === answer));
            answersContainer.appendChild(button);
        });

        questionImg = questionsList[questionId].image
        var img = document.getElementById('question-img');

        if (!!questionImg) {
            img.src = questionImg;
            img.style.display = 'inline';
        } else {
            img.style.display = 'none';
        }

        categoryName = questionsList[questionId].category;
        var category = document.getElementById('category');
        category.innerText = categoryName;

        subCategoryName = questionsList[questionId].subcategory;
        var subcategory = document.getElementById('subcategory');
        subcategory.innerText = subCategoryName;
    }

    function nextQuestion() {
        if (questionId < questionsList.length - 1) {
            questionId += 1;
            setQuestion()
        }
    }

    function previousQuestion() {
        if (questionId > 0) {
            questionId -= 1;
            setQuestion()
        }
    }

    function colorAnswers() {
        const answersContainer = document.getElementById('answers');

        var buttons = answersContainer.querySelectorAll("button");

        buttons.forEach(function (button) {
            if (button.getAttribute('is_correct_answer') === 'true') {
                button.style.backgroundColor = 'green';
            } else {
                button.style.backgroundColor = 'red';
            }

            button.setAttribute('onclick', '');
        });
    }

    function checkAnswer(clickedButton) {
        const answersContainer = document.getElementById('answers');

        var buttons = answersContainer.querySelectorAll("button");

        buttons.forEach(function (button) {
            if (button.getAttribute('is_correct_answer') === 'true') {
                button.className = 'answer-correct';
            } else {
                button.className = 'answer-incorrect';
            }

            button.setAttribute('onclick', '');
        });

        if (clickedButton.getAttribute('is_correct_answer') === 'true') {
            clickedButton.className = 'answer-selected-correct';
        } else {
            clickedButton.className = 'answer-selected-incorrect';
        }
    }

</script>

<div class="container">
    <div id="information">
        <div style="display: inline">
            <div><b>Kategoria:</b> </div>
            <div id="category"></div>
        </div>
        <div style="display: inline">
            <div><b>Podkategoria:</b> </div>
            <div id="subcategory"></div>
        </div>
        <div style="display: inline">
            <div><b>Pytanie:</b> </div>
            <div id="question-number"></div>
        </div>
    </div>
    <h1 id="question"></h1>
    <img id="question-img"/>
    <div id="answers"></div>

    <div class="navigation-buttons">
        <button id="previousButton" onclick="previousQuestion()">Poprzednie pytanie</button>
        <button id="nextButton" onclick="nextQuestion()">Nastepne pytanie</button>
    </div>
</div>
</body>
</html>

